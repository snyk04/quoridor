@startuml <diagram.png>

'-----Model-----'
    
interface IModel
{
    StartNewGame() : void
    MoveCurrentPlayerToCell() : void
}
class ModelCommunication #brown
{
    view : IView 

    possibleMoves : PossibleMoves
    cellsManager : CellsManager
    gameCycle : GameCycle
    playersController : PlayersController
    
    HighlightAvailableCells() : void
    EndGame() : void
    MovePlayerToCell() : void
}

class Cell
{
    IsBusy : bool
}
class CellsManager
{
    AmountOfRows : int
    AmountOfColumns : int
    
    cells : Cell[,]
    
    InitializeCellField() : void
    
    CheckIfCellIsReal() : bool
    CheckIfCellIsBusy() : bool
}
class GameCycle
{
    model : Model

    gameMode : GameMode
    
    OnGameStart : Action
    OnGameEnd : Action
    
    StartNewGame() : void
    EndGame() : void
}
class PlayersController
{
    model : ModelCommunication
    
    firstPlayerStartPosition : CellCoordinates
    secondPlayerStartPosition : CellCoordinates

    firstPlayer : Player
    secondPlayer : Player
    
    bot : Bot   
    
    currentPlayer : Player
    currentPlayerType : PlayerType
    
    HandleTurnEndEvents() : void
    NullifyTurnEndEvents() : void
    
    PlacePlayersAtStartPositions() : void
    
    MovePlayerToCell() : void
    MoveCurrentPlayerToCell() : void
    
    WaitForTheFirstPlayer() : void
    WaitForTheNextPlayer() : void
        
    ComputeBotMove() : void
    BotTurn() : void
    
    ChangeCurrentPlayer() : void
}
class PossibleMoves
{
    model : ModelCommunication
    
    currentTurnPlayerCoordinates : CellCoordinates
    
    SetCurrentTurnPlayerCoordinates() : void
    
    TryToAddCellToPossibleMoves() : void
    GetPossibleMovesFromCell() : void
    ShowPossibleMoves() : void
}

class Player
{
    CurrentCellCoordinates : CellCoordinates
    
    MoveToCell() : void
}
abstract class Bot
{
    CellToMove : CellCoordinates
    
    MakeMove() : MoveType
}
class RandomBot

IModel <|.. ModelCommunication

ModelCommunication o- ViewCommunication

ModelCommunication *--o PossibleMoves
ModelCommunication *-- CellsManager
ModelCommunication *--o GameCycle
ModelCommunication *--o PlayersController

CellsManager *-- Cell

PlayersController *-- Player
PlayersController *-- Bot
Player <|- Bot
Bot <|-- RandomBot
    
'-----View-----'

interface IView
{
    HighlightCells() : void
    MovePlayerToCell() : void
    PlaceWall() : void

    EndGame() : void
}
class ViewCommunication #brown

interface IEnumerable<T>
{
    GetEnumerator() : IEnumerator<T>
}
class Storage<T>

class CellHighlighter
{
    UnhighlightAllCells() : void
    HighlightCells() : void
}
class CellStorage
class CellVisual
{
    Highlight() : void
    Unhighlight() : void
}

class WallPlacer
{
    PlaceWall() : void
}
class WallStorage
class WallVisual
{
    HandlePlace() : void
    
    Highlight() : void
    Unhighlight() : void
}

class PlayerMover
{
    MovePlayerToCell() : void
}
    
IView <|..  ViewCommunication

Storage .|> IEnumerable
CellStorage -|> Storage
WallStorage -|> Storage

ViewCommunication o-- CellHighlighter
ViewCommunication o-- PlayerMover
ViewCommunication o-- WallPlacer

CellHighlighter o-- CellStorage
PlayerMover o-- CellStorage
CellStorage o-- CellVisual

WallPlacer o-- WallStorage
WallStorage o-- WallVisual

'-----Controller-----'

interface IController
{
    StartNewGame() : void
    Quit() : void
    
    ChooseCell() : void
    TryToPlaceWall() : void
}

class ControllerCommunication #brown

class GameModeController
{
    GameMode : GameMode
}

abstract class Button
{
    NotifyController() : void
}
class CellButton
class WallButton

IController <|.. ControllerCommunication

ControllerCommunication *- ModelCommunication

ControllerCommunication o-- GameModeController

Button <|-- CellButton
Button <|-- WallButton
CellButton o-- ControllerCommunication
WallButton o-- ControllerCommunication

@enduml